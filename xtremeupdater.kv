#:kivy 1.10.0

#:import theme theme
#:import Thread threading.Thread
#:import WindowDragBehavior main.WindowDragBehavior
#:import Window kivy.core.window.Window

RootLayout:
<Widget>:
    font_name: 'fnt/Roboto-Regular.ttf'

<CustButton@Button>:
    background_color: Window.clearcolor
    background_normal: 'img/FFFFFF-1.png'
    background_down: self.background_normal

<ContentLayout@BoxLayout>:
    orientation: 'vertical'

    canvas.before:
        Color:
            rgba: theme.dark

        Rectangle:
            pos: self.pos
            size: self.size

<HeaderButton@CustButton>:
    size_hint_x: None
    width: self.height

<IconButton@CustButton>:
    size_hint_x: None
    width: self.height
    font_name: 'fnt/segmdl2.ttf'
    font_size: 20
    background_color: theme.sec
    background_down: self.background_normal

<NavigationButton@CustButton>:
    size_hint_x: None
    width: 120
    background_color: theme.dark
    font_name: 'fnt/Roboto-Bold.ttf'
    font_size: 18
    background_normal: 'img/noise_texture.png'

<IconNavigationButton@NavigationButton>:
    width: self.height
    font_name: 'fnt/MaterialIcons-Regular.ttf'
    font_size: 20

<Navigation@BoxLayout>:
    size_hint_y: None
    height: 40

    canvas.before:
        Color:
            rgba: theme.dark

        Rectangle:
            pos: root.pos
            size: root.size

<SelectableLabel>:
    text_size: self.size
    halign: 'left'
    valign: 'center'
    padding: 50, 0

    canvas.before:
        Color:
            rgba: theme.prim if self.selected else theme.sec
        Rectangle:
            pos: self.pos
            size: self.size

<PlaceHolder@Label>:    
    text: self.rendered_text
    markup: True
    color: theme.prim
    font_size: 36
    text_size: self.size
    halign: 'center'
    valign: 'center'

<OverwriteLabel@FloatLayout>:
    size_hint: None, None
    size: 0, 0
    opacity: 0

    Label:
        id: label

        canvas.before:
            Color:
                rgba: theme.sec

            Rectangle:
                pos: self.pos
                size: self.size

        pos: root.wg.pos
        size_hint: None, None
        size: root.wg.size
        color: theme.prim
        markup: True
        font_size: 36
        text_size: self.size
        text: f'[size=72][font=fnt/segmdl2.ttf]{root.icon}[/font][/size]\n{root.text}'
        halign: 'center'
        valign: 'center'
        opacity: root.opacity

<Content@PageLayout>:
    border: 0

<RootLayout>:
    orientation: 'vertical'

    BoxLayout:
        id: header
        size_hint_y: None
        height: 30

        HeaderLabel:
            id: header_label
            text: 'XtremeUpdater'
            text_size: self.size
            halign: 'left'
            padding: 10, 5
            color: theme.prim

        HeaderButton:
            id: minimize_button
            text: '\u2212'
            on_release: Window.minimize()

        HeaderButton:
            id: close_button
            text: '\u00d7'
            on_release: app.stop()

    Navigation:
        id: navigation
        page_layout: content

        NavigationButton:
            id: navCustButtonupdater
            text: 'Updater'
            page_index: 0

        NavigationButton:
            id: navCustButtongames
            text: 'Games'
            page_index: 1

        NavigationButton:
            id: navCustButtonsystem
            text: 'System'
            page_index: 2

        Widget:

        IconNavigationButton:
            text: '\ue838' 
            page_index: 3

        IconNavigationButton:
            text: '\ue8b8'
            page_index: 4

    Content:
        id: content

        ContentLayout:
            id: content_updater

            BoxLayout:
                size_hint_y: None
                height: 40

                Label:
                    id: content_updater_path_info
                    text: 'Game/path/here/'
                    text_size: self.size
                    halign: 'left'
                    padding: 10, 5
                    color: theme.sec

                IconButton:
                    text: '\uf12b'
                    background_color: theme.dark
                    on_release: Thread(target=root.load_directory).start()
            
            BoxLayout:
                id: dll_view_holder

                DllRecycleView:
                    id: dll_view
                    viewclass: 'SelectableLabel'
                    bar_color: theme.prim

                    SelectableRecycleBoxLayout:
                        id: selectable_recycle_box_layout
                        default_size: None, 26
                        default_size_hint: 1, None
                        size_hint_y: None
                        height: self.minimum_height
                        orientation: 'vertical'
                        multiselect: True
                        touch_multiselect: True

            BoxLayout:
                id: update_and_restore_layout
                size_hint_y: None
                height: 40
                padding: 10, 0

                canvas.before:
                    Color:
                        rgba: theme.sec

                    Rectangle:
                        pos: update_and_restore_layout.pos
                        size: update_and_restore_layout.size

                Widget:

                CustButton:
                    id: restore_button
                    size_hint_x: None
                    text: 'Restore'
                    font_name: 'fnt/Roboto-Bold.ttf'
                    font_size: 18
                    text_size: self.size
                    halign: 'center'
                    valign: 'bottom'

                CustButton:
                    id: update_button
                    size_hint_x: None
                    text: 'Update'
                    font_name: 'fnt/Roboto-Bold.ttf'
                    font_size: 24
                    text_size: self.size
                    halign: 'center'
                    valign: 'bottom'

        ContentLayout:
            id: content_games

            PlaceHolder:
                icon: '\ue7fc'
                shown_text: 'Game collection coming soon'

        ContentLayout:
            id: content_system

            PlaceHolder:
                icon: '\ue770'
                shown_text: 'System tweaks coming soon'

        ContentLayout:
            id: content_favorite

            PlaceHolder:
                icon: '\ue734'
                shown_text: 'Favorite games coming soon'

        ContentLayout:
            id: content_settings

            PlaceHolder:
                icon: '\ue713'
                shown_text: 'Nothing to set yet'

    Label:
        id: info_label
        size_hint_y: None
        height: 30
        text_size: self.size
        halign: 'left'
        font_name: 'fnt/Roboto-Medium.ttf'
        font_size: 12
        padding: 10, 5
        text: "Welcome to XtremeUpdater | Let's start"
        color: theme.prim
